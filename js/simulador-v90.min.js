const barsDiagrams=document.querySelectorAll(".diagrama-barras"),diagramCF=document.getElementById("diagramaNominaCF"),diagramSF=document.getElementById("diagramaNominaSF"),divRF=diagramCF.querySelector(".servicios"),divNetoCF=diagramCF.querySelector(".dinero"),divTaxesCF=diagramCF.querySelector(".impuestos"),divNetoSF=diagramSF.querySelector(".dinero"),divTaxesSF=diagramSF.querySelector(".impuestos"),brutoInput=document.querySelector(".range-slider.reverse input.range-slider__value");var brutoVal,brutoSinRF,rfValue,netoValueCF,taxesValueCF,netoValueSF,taxesValueSF,sueldoValueSF,sueldoValueCF,ahorroAnual,ahorroMensual,baseImpCF,baseImpSF,seguridadSocial;const netoDiagramCF=document.querySelector(".SN_CF strong"),netoDiagramSF=document.querySelector(".SN_SF strong");var servicios=document.querySelector(".servicios"),servicios_tam=servicios.offsetWidth,servicios_child=servicios.firstElementChild;const CENTIMOS=!1,current_Value=0;function formatValue(e,a){let t;return CENTIMOS?t=(a?new Intl.NumberFormat("de-DE",{style:"currency",currency:"EUR"}):new Intl.NumberFormat("de-DE")).format(e):(t=e.replace(/\D/g,"").replace(/\B(?=(\d{3})+(?!\d))/g,"."),a&&(t+="€")),t}function deformatValue(e){let a=e.replace(/€/g,"");return a=a.replace(/\./g,""),a}function formatSliderValue(e){return 12!=e.getAttribute("max")?formatValue(e.value,!0):e.value}function isMoney(e){let a=!0;return 12==parseInt(e.max)&&(a=!1),a}function getMaxElement(e){return e.nextElementSibling.nextElementSibling}function getMinElement(e){return e.nextElementSibling}function getValueElement(e){return e.parentElement.nextElementSibling}function getSliderElement(e){return e.previousElementSibling.firstElementChild}function newSize(e,a){a="1 1 "+round(a).toString()+"%";e.style.flex=a}function updateDiagramSection(e,a){a=round(a),l_width=100*a/brutoVal,newSize(e,l_width)}function updateSueldoNeto(){netoDiagramCF.innerHTML=formatValue(round(netoValueCF).toString(),!0),netoDiagramSF.innerHTML=formatValue(round(netoValueSF).toString(),!0),document.getElementById("servicios").style=0==rfValue?"margin: 0px":"margin: 1px"}const ahorroTotal=document.querySelector(".ahorroTotal .valor-ahorro-anual strong"),ahorroTotal_Mobile=document.querySelector(".floating-card .ahorroTotal .valor-importe-total");function updateAhorro(){ahorroTotal.innerHTML=formatValue(ahorroAnual.toString(),!1)+'<span class="small-cifra">€</span>',ahorroTotal_Mobile.innerHTML=formatValue(ahorroAnual.toString(),!0)}var tableSF=document.getElementById("tabledata-SF"),tableCF=document.getElementById("tabledata-CF");function updTableVal(e,a,t){a--,e.querySelectorAll(".table-row")[a].querySelector("p:not(.subtitle)").innerHTML=formatValue(round(t).toString(),!0)}function updateDataTable(){updTableVal(tableSF,1,brutoVal),updTableVal(tableSF,2,0),updTableVal(tableSF,3,baseImpSF),updTableVal(tableSF,4,taxesValueSF),updTableVal(tableSF,5,sueldoValueSF),updTableVal(tableCF,1,brutoVal),updTableVal(tableCF,2,rfValue),updTableVal(tableCF,3,baseImpCF),updTableVal(tableCF,4,taxesValueCF),updTableVal(tableCF,5,sueldoValueCF),updTableVal(tableCF,6,ahorroMensual)}function updateDiagram(){updateSueldoNeto(),updateDiagramSection(divNetoCF,netoValueCF-rfValue),updateDiagramSection(divRF,rfValue),updateDiagramSection(divTaxesCF,taxesValueCF+seguridadSocial),updateDiagramSection(divNetoSF,netoValueSF),updateDiagramSection(divTaxesSF,taxesValueSF+seguridadSocial)}function updateResults(){calculaAhorroFiscalPct(brutoVal=parseInt(deformatValue(brutoInput.value)),rfValue),updateAhorro(),updateDiagram(),updateDataTable(),barsDiagrams[1].innerHTML=barsDiagrams[0].innerHTML}var cardMoneyRF=document.getElementById("moneyRF"),cardMoneyRF_Mobile=document.getElementById("moneyRF_Mobile"),errorDesktop=document.querySelector(".five.columns"),errorMobile=document.getElementById("errorMobile"),arrowSVG=document.getElementById("arrow-blue");const MaxRTAllowed=document.querySelector("#errorDesktop span"),MaxRTAllowed_Mobile=document.querySelector("#errorMobile span");function updateErrorRF(){brutoVal=parseInt(deformatValue(brutoInput.value));let e=parseInt(.3*brutoVal);rfValue>e?(cardMoneyRF.classList.add("error"),cardMoneyRF_Mobile.classList.add("error"),arrowSVG.classList.add("svg-error"),errorDesktop.classList.add("limit-exception"),errorMobile.classList.remove("hide"),MaxRTAllowed.innerHTML=formatValue(e.toString()),MaxRTAllowed_Mobile.innerHTML=formatValue(e.toString())):(cardMoneyRF.classList.remove("error"),cardMoneyRF_Mobile.classList.remove("error"),arrowSVG.classList.remove("svg-error"),errorDesktop.classList.remove("limit-exception"),errorMobile.classList.add("hide"))}const MoneyEachProduct=document.querySelectorAll(".input-rt .titulo-producto span:nth-child(2)>span"),moneyRF=document.querySelector("#moneyRF .valor-importe-total"),moneyRF_Mobile=document.querySelector("#moneyRF_Mobile .valor-importe-total");function updTotalRT(){rfValue=0,MoneyEachProduct.forEach(e=>{rfValue+=parseInt(deformatValue(e.innerHTML))});moneyRF.innerHTML=formatValue(rfValue.toString(),!1)+'<span class="small-cifra">€</span>',moneyRF_Mobile.innerHTML=formatValue(rfValue.toString(),!0),updateResults(),updateErrorRF()}function updProduct(t){let o=t.closest(".input-rt");if(o){let e=o.querySelector(".titulo-producto span:nth-child(2)>span");t=o.querySelector("input[type=text]");let a=0;a="formacion"==o.id?deformatValue(t.value):12*deformatValue(t.value),e.innerHTML=formatValue(a.toString(),!0),updTotalRT()}else updateResults(),updateErrorRF()}var rangeSlider=function(){var e=document.querySelectorAll(".range-slider__range");document.querySelectorAll(".range-slider__value").forEach(e=>{e.setAttribute("value",formatSliderValue(getSliderElement(e)))}),e.forEach(e=>{getMaxElement(e).innerHTML=formatValue(e.max,isMoney(e)),getMinElement(e).innerHTML=formatValue(e.min,isMoney(e)),e.addEventListener("input",function(){getValueElement(this).value=formatSliderValue(this),updProduct(e)})})};rangeSlider(),updTotalRT();const inputsRF=document.querySelectorAll(".simulador .range-slider__value");function checkHijos(){0<inputsHijos[0].value?inputsHijos[1].parentElement.classList.remove("disabled"):inputsHijos[1].parentElement.classList.add("disabled")}function checkMaxMinHijos(){inputsHijos[1].value>parseInt(inputsHijos[0].value)&&(inputsHijos[1].value=inputsHijos[0].value)}function updateHijos(){checkHijos(),checkMaxMinHijos(),updateResults()}inputsRF.forEach(a=>{a.addEventListener("keypress",e=>{13==e.which?a.blur():BIRTHNUMBER_ALLOWED_CHARS_REGEXP.test(e.key)||e.preventDefault()}),a.addEventListener("focus",function(){current_value=deformatValue(this.value),this.value="",hideFloatingCard()}),a.addEventListener("input",function(){this.value=formatValue(this.value,!1),current_value=this.value}),a.addEventListener("focusout",function(){var e=parseInt(this.max),a=parseInt(this.min);let t=deformatValue(this.value);t=""==t?current_value:parseInt(t),t>e?t=e:t<a&&(t=a);let o=getSliderElement(this);o.value=t,this.value=formatValue(t.toString(),isMoney(o)),updProduct(this),showFloatingCard()}),updProduct(a)}),window.inputNumber=function(e){var t,o,r={};e.forEach(e=>{var a;o=e.getAttribute("min")||!1,t=e.getAttribute("max")||!1,r.dec=e.previousElementSibling,r.inc=e.nextElementSibling,a=e,r.dec.addEventListener("click",function(){var e=a.value;e--,(!o||o<=e)&&(a.value=e),updateHijos()}),r.inc.addEventListener("click",function(){var e=a.value;e++,(!t||e<=t)&&(a.value=e++),updateHijos()})})};const inputsHijos=document.querySelectorAll(".simulador .input-number");inputNumber(inputsHijos);const BIRTHNUMBER_ALLOWED_CHARS_REGEXP=/[0-9]+/;function reiniciarSimulador(e){if(inputsHijos.forEach(e=>{e.value=0,updateHijos()}),inputsRF.forEach(e=>{l_value=0,"15000"==e.min&&(l_value=4e4);let a=getSliderElement(e);a.value=l_value,e.value=formatValue(l_value.toString(),isMoney(a)),updProduct(e)}),updTotalRT(),e){close();const a=document.getElementById("sueldo");e=a.getBoundingClientRect().top+window.pageYOffset+-70;window.scrollTo({top:e,behavior:"smooth"})}}inputsHijos.forEach(a=>{a.addEventListener("keypress",e=>{13==e.which?a.blur():BIRTHNUMBER_ALLOWED_CHARS_REGEXP.test(e.key)||e.preventDefault()}),a.addEventListener("focus",function(){this.value=""}),a.addEventListener("focusout",function(){var e=parseInt(this.max),a=parseInt(this.min);this.value>e?this.value=e:(""==this.value||this.value<a)&&(this.value=a),updateHijos()})});const svg_event=document.querySelector(".floating-card .arrow");let opened=!1;function open(){document.getElementById("floating-card-simulador").classList.add("show"),opened=!0}function close(){document.getElementById("floating-card-simulador").classList.remove("show"),opened=!1}function hideFloatingCard(){var e=document.getElementById("floating-card-simulador");null!=e&&e.classList.add("oculto")}function showFloatingCard(){var e=document.getElementById("floating-card-simulador");null!=e&&e.classList.remove("oculto")}svg_event.addEventListener("click",function(){1==opened?close():0==opened&&open()});var phcard=document.getElementById("floating-card-simulador");function card(){window.pageYOffset<500?phcard.classList.add("none"):phcard.classList.remove("none")}function goToTables(){close();const e=document.getElementById("titulo-resultados");var a=e.getBoundingClientRect().top+window.pageYOffset+-70;window.scrollTo({top:a,behavior:"smooth"})}function getHijos(){let e=document.getElementById("num_hijos");return e.querySelector("input").value}function getMenores(){let e=document.getElementById("num_hijos_menores");return e.querySelector("input").value}function calculaAhorroFiscalPct(e,a){var t=getHijos(),o=getMenores();rendimientos_Factorial=e-a,ss=.0635,gastos_deducibles=Math.min(ss*e,3101.42),gastos_genericos_deducibles=2e3,rnt=e-gastos_deducibles-gastos_genericos_deducibles,rnt_Factorial=rendimientos_Factorial-gastos_deducibles-gastos_genericos_deducibles,minimo_personal=5550,reduccion_generica_bi_irpf=0,rnt+gastos_genericos_deducibles<=13115?reduccion_generica_bi_irpf=5565:rnt+gastos_genericos_deducibles<16825&&(reduccion_generica_bi_irpf=5565-1.5*(rnt+gastos_genericos_deducibles-13115)),reduccion_generica_bi_irpf_Factorial=0,rnt_Factorial+gastos_genericos_deducibles<=13115?reduccion_generica_bi_irpf_Factorial=5565:rnt_Factorial+gastos_genericos_deducibles<16825&&(reduccion_generica_bi_irpf_Factorial=5565-1.5*(rnt_Factorial+gastos_genericos_deducibles-13115)),base_imponible=rnt-reduccion_generica_bi_irpf,base_imponible_Factorial=rnt_Factorial-reduccion_generica_bi_irpf_Factorial,minimo_personal_familiar=minimo_personal+.5*o*2800,minimo_personal_familiar+=0==t?0:1==t?1200:2==t?2550:3==t?4550:4==t?6800:6800+.5*(t-4),familia_numerosa=2<t?600:0,cuota1=2365.5,cuota2=4225.5,cuota3=8725.5,cuota4=17901.5,pct0=.19,pct1=.24,pct2=.3,pct3=.37,pct4=.45,base0=12450,base1=20200,base2=35200,base3=6e4,cuota=base_imponible>base3?cuota4+pct4*(base_imponible-base3):base_imponible>base2?cuota3+pct3*(base_imponible-base2):base_imponible>base1?cuota2+pct2*(base_imponible-base1):base_imponible>base0?cuota1+pct1*(base_imponible-base0):base_imponible*pct0,cuota_Factorial=base_imponible_Factorial>base3?cuota4+pct4*(base_imponible_Factorial-base3):base_imponible_Factorial>base2?cuota3+pct3*(base_imponible_Factorial-base2):base_imponible_Factorial>base1?cuota2+pct2*(base_imponible_Factorial-base1):base_imponible_Factorial>base0?cuota1+pct1*(base_imponible_Factorial-base0):base_imponible_Factorial*pct0,parte=minimo_personal_familiar>base3?cuota4+pct4*(minimo_personal_familiar-base3):minimo_personal_familiar>base2?cuota3+pct3*(minimo_personal_familiar-base2):minimo_personal_familiar>base1?cuota2+pct2*(minimo_personal_familiar-base1):minimo_personal_familiar>base0?cuota1+pct1*(minimo_personal_familiar-base0):minimo_personal_familiar*pct0,cuota_integra=round(cuota-parte-familia_numerosa<0?0:cuota-parte-familia_numerosa),cuota_integra_Factorial=round(cuota_Factorial-parte-familia_numerosa<0?0:cuota_Factorial-parte-familia_numerosa),ahorro_fiscal=round(cuota_integra-cuota_integra_Factorial),brutoSinRF=rendimientos_Factorial,seguridadSocial=ss*e,taxesValueCF=cuota_integra_Factorial,netoValueCF=e-cuota_integra_Factorial-seguridadSocial,sueldoValueCF=netoValueCF/12,taxesValueSF=cuota_integra,netoValueSF=e-cuota_integra-seguridadSocial,sueldoValueSF=netoValueSF/12,ahorroAnual=ahorro_fiscal,ahorroMensual=ahorroAnual/12,baseImpCF=base_imponible_Factorial,baseImpSF=base_imponible}function round(e){let a;if(a=CENTIMOS?2:0,(""+e).includes("e")){var t=(""+e).split("e"),o="";return 0<+t[1]+a&&(o="+"),+(Math.round(+t[0]+"e"+o+(+t[1]+a))+"e-"+a)}return+(Math.round(e+"e+"+a)+"e-"+a)}window.addEventListener("scroll",card);